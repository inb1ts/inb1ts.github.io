<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>New Tool: CSSHide - Hiding in plain style | Inbits Blog</title><meta name=keywords content><meta name=description content="I&rsquo;ve recently been working on a small fun obfuscation tool called CSSHide, which can encode a payload in the colour values of a CSS file. This was inspired by the payload encoding modules featured at Maldev Academy, that include encoding payloads as IP addresses, UUIDs, and MAC addresses.
Why CSS files? The purpose of the tool is to help facilitate blending in with common browser traffic, which will usually include frequent requests for CSS files that the browser will then use to format the layout of a webpage."><meta name=author content="Tom Brice"><link rel=canonical href=https://inbits-sec.com/posts/new-tool-csshide/><link crossorigin=anonymous href=/assets/css/stylesheet.min.a8c7cefc3a1d5f4123aa17c5c746a0d812ed0907d1aba94226bb35d21671a605.css integrity="sha256-qMfO/DodX0EjqhfFx0ag2BLtCQfRq6lCJrs10hZxpgU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://inbits-sec.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://inbits-sec.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://inbits-sec.com/favicon-32x32.png><link rel=apple-touch-icon href=https://inbits-sec.com/apple-touch-icon.png><link rel=mask-icon href=https://inbits-sec.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="New Tool: CSSHide - Hiding in plain style"><meta property="og:description" content="I&rsquo;ve recently been working on a small fun obfuscation tool called CSSHide, which can encode a payload in the colour values of a CSS file. This was inspired by the payload encoding modules featured at Maldev Academy, that include encoding payloads as IP addresses, UUIDs, and MAC addresses.
Why CSS files? The purpose of the tool is to help facilitate blending in with common browser traffic, which will usually include frequent requests for CSS files that the browser will then use to format the layout of a webpage."><meta property="og:type" content="article"><meta property="og:url" content="https://inbits-sec.com/posts/new-tool-csshide/"><meta property="og:image" content="https://inbits-sec.com/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-05T15:58:43+01:00"><meta property="article:modified_time" content="2023-09-05T15:58:43+01:00"><meta property="og:site_name" content="Inbits"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://inbits-sec.com/"><meta name=twitter:title content="New Tool: CSSHide - Hiding in plain style"><meta name=twitter:description content="I&rsquo;ve recently been working on a small fun obfuscation tool called CSSHide, which can encode a payload in the colour values of a CSS file. This was inspired by the payload encoding modules featured at Maldev Academy, that include encoding payloads as IP addresses, UUIDs, and MAC addresses.
Why CSS files? The purpose of the tool is to help facilitate blending in with common browser traffic, which will usually include frequent requests for CSS files that the browser will then use to format the layout of a webpage."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://inbits-sec.com/posts/"},{"@type":"ListItem","position":2,"name":"New Tool: CSSHide - Hiding in plain style","item":"https://inbits-sec.com/posts/new-tool-csshide/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"New Tool: CSSHide - Hiding in plain style","name":"New Tool: CSSHide - Hiding in plain style","description":"I\u0026rsquo;ve recently been working on a small fun obfuscation tool called CSSHide, which can encode a payload in the colour values of a CSS file. This was inspired by the payload encoding modules featured at Maldev Academy, that include encoding payloads as IP addresses, UUIDs, and MAC addresses.\nWhy CSS files? The purpose of the tool is to help facilitate blending in with common browser traffic, which will usually include frequent requests for CSS files that the browser will then use to format the layout of a webpage.","keywords":[],"articleBody":"I’ve recently been working on a small fun obfuscation tool called CSSHide, which can encode a payload in the colour values of a CSS file. This was inspired by the payload encoding modules featured at Maldev Academy, that include encoding payloads as IP addresses, UUIDs, and MAC addresses.\nWhy CSS files? The purpose of the tool is to help facilitate blending in with common browser traffic, which will usually include frequent requests for CSS files that the browser will then use to format the layout of a webpage. For example, here are all the CSS files requested when loading a youtube video:\nHow it works For those unfamiliar with CSS, it is a stylesheet language used to style HTML elements. A CSS file will usually contain multiple “rulesets”, which consist of a selector that matches a HTML element name, some properties, and values for those properties. The following image taken from Mozilla docs shows what a very basic ruleset might look like:\nThese rulesets are parsed by the browser, after which the styles are applied to DOM nodes (a representation of the document in-memory that the HTML has been converted to).\nThe example in the image above uses a colour property - there are multiple ways of representing colour property values in CSS, but two formats in particular are useful for us wanting to encode parts of our payload:\nRGB values: rgb(152 42 87) Hex values: #ffb71d Each value can hold 3 bytes of information that correspond to Red/Green/Blue (rgb also can include a fourth byte for an Alpha value, but the tool currently isn’t utilising this). CSSHide works by splitting a payload into 3-byte chunks and formatting those bytes into the colour values.\nOnce we’ve translated our payload into a list of these colour values, the tool generates a CSS file that incorporates them. It starts by creating a short block of CSS variables, which is a quick way of legitimately using many colours in quick succession. Then after the variable section, the remaining colour values are placed in CSS blocks that use a selector randomly picked from a list of generic CSS class selectors that are included in the project.\nBy default the output is then minified, a process used to save space by removing any whitespace from the file that doesn’t impact the CSS property values. The minifying can be disabled with a flag if desired. Some examples of the different output styles are included in the github readme.\nThe tool is best suited to smaller payloads, as typically CSS files aren’t too big. Larger payloads still work (as per the demo below), but defeat the purpose of the obfuscation by producing a suspiciously large CSS file.\nhttps://github.com/inb1ts/CSSHide\nDemo ","wordCount":"452","inLanguage":"en","datePublished":"2023-09-05T15:58:43+01:00","dateModified":"2023-09-05T15:58:43+01:00","author":{"@type":"Person","name":"Tom Brice"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://inbits-sec.com/posts/new-tool-csshide/"},"publisher":{"@type":"Organization","name":"Inbits Blog","logo":{"@type":"ImageObject","url":"https://inbits-sec.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://inbits-sec.com/ accesskey=h title="Inbits Blog (Alt + H)">Inbits Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://inbits-sec.com/about/ title="about me"><span>about me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>New Tool: CSSHide - Hiding in plain style</h1><div class=post-meta><span title='2023-09-05 15:58:43 +0100 BST'>September 5, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Tom Brice</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#why-css-files aria-label="Why CSS files?">Why CSS files?</a></li><li><a href=#how-it-works aria-label="How it works">How it works</a></li><li><a href=#demo aria-label=Demo>Demo</a></li></ul></div></details></div><div class=post-content><p>I&rsquo;ve recently been working on a small fun obfuscation tool called <a href=https://github.com/inb1ts/CSSHide target=_blank rel=noopener>CSSHide</a>, which can encode a payload in the colour values of a CSS file. This was inspired by the payload encoding modules featured at <a href=https://maldevacademy.com/ target=_blank rel=noopener>Maldev Academy</a>, that include encoding payloads as IP addresses, UUIDs, and MAC addresses.</p><h2 id=why-css-files>Why CSS files?<a hidden class=anchor aria-hidden=true href=#why-css-files>#</a></h2><p>The purpose of the tool is to help facilitate blending in with common browser traffic, which will usually include frequent requests for CSS files that the browser will then use to format the layout of a webpage. For example, here are all the CSS files requested when loading a youtube video:</p><p><img loading=lazy src=/csshide_browser_requests.png#center alt="Browser CSS file requests"></p><h2 id=how-it-works>How it works<a hidden class=anchor aria-hidden=true href=#how-it-works>#</a></h2><p>For those unfamiliar with CSS, it is a stylesheet language used to style HTML elements. A CSS file will usually contain multiple &ldquo;rulesets&rdquo;, which consist of a selector that matches a HTML element name, some properties, and values for those properties. The following image taken from <a href=https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/CSS_basics target=_blank rel=noopener>Mozilla docs</a> shows what a very basic ruleset might look like:</p><p><img loading=lazy src=/csshide_moz_css_ruleset.png#center alt="CSS ruleset anatomy"></p><p>These rulesets are parsed by the browser, after which the styles are applied to DOM nodes (a representation of the document in-memory that the HTML has been converted to).</p><p>The example in the image above uses a colour property - there are multiple ways of representing colour property values in CSS, but two formats in particular are useful for us wanting to encode parts of our payload:</p><ul><li>RGB values: <code>rgb(152 42 87)</code></li><li>Hex values: <code>#ffb71d</code></li></ul><p>Each value can hold 3 bytes of information that correspond to Red/Green/Blue (<code>rgb</code> also can include a fourth byte for an Alpha value, but the tool currently isn&rsquo;t utilising this). CSSHide works by splitting a payload into 3-byte chunks and formatting those bytes into the colour values.</p><p>Once we&rsquo;ve translated our payload into a list of these colour values, the tool generates a CSS file that incorporates them. It starts by creating a short block of CSS variables, which is a quick way of legitimately using many colours in quick succession. Then after the variable section, the remaining colour values are placed in CSS blocks that use a selector randomly picked from a list of generic CSS class selectors that are included in the project.</p><p>By default the output is then minified, a process used to save space by removing any whitespace from the file that doesn&rsquo;t impact the CSS property values. The minifying can be disabled with a flag if desired. Some examples of the different output styles are included in the github readme.</p><p>The tool is best suited to smaller payloads, as typically CSS files aren&rsquo;t too big. Larger payloads still work (as per the demo below), but defeat the purpose of the obfuscation by producing a suspiciously large CSS file.</p><p><a href=https://github.com/inb1ts/CSSHide target=_blank rel=noopener>https://github.com/inb1ts/CSSHide</a></p><h2 id=demo>Demo<a hidden class=anchor aria-hidden=true href=#demo>#</a></h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/6jQSTp75KjI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://inbits-sec.com/posts/cve-2024-11616-netskope/><span class=title>« Prev</span><br><span>CVE-2024-11616: Netskope EPDLP Double-Fetch</span></a>
<a class=next href=https://inbits-sec.com/posts/openfilemapping-and-knowndlls/><span class=title>Next »</span><br><span>OpenFileMapping and KnownDlls</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://inbits-sec.com/>Inbits Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>