
- Via the `ScanContainers` function
- Reached by IOCTL `0x80076816`

### Root Cause

- The header structure for `ContainerInfo` in the supplied output buffer is not taken into consideration when performing the upper-bounds-limit check on the buffer.
- As such, it's possible to overflow the buffer by `0x38` bytes
	- There are various writes to this location

- `CLS_CONTAINER_INFORMATION` is `0x240` bytes in size
- Our input buffer specifies how many containers we want to receive information about
	- It uses this value `* 0x240` to perform an upper bounds check on the output buffer length
- This fails to take into consideration, the fact that our input buffer also included a  `+0x38` byte header. This `0x38` byte offset is not taken into consideration in the bounds check.
- 


![[clfs_bsod.png]]